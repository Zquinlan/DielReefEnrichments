Organism == "DT" ~ "Dictyota",
Organism == "PL" ~ "Porites lobata",
Organism == "PV" ~ "Pocillopora verrucosa",
Organism == "TR" ~ "Turf",
Organism == "WA" ~ "Water control",
TRUE ~ as.character(Organism)))%>%
separate(Timepoint, c("Timepoint", "DayNight"), sep = 2)%>%
mutate(DayNight = case_when(DayNight == "D" ~ "Day",
TRUE ~ "Night"),
xic = case_when(xic == 0 ~ 1000,
TRUE ~ as.numeric(xic)))%>%
group_by(Organism, Timepoint, DayNight, feature_number)%>%
mutate(Replicate = as.numeric(Replicate),
xic = case_when(sum(xic) == 4000 ~ xic + Replicate,
sum(xic) == 2000 ~ xic + Replicate,
TRUE ~ as.numeric(xic)))%>%
ungroup()%>%
spread(Timepoint, xic)%>%
group_by(Organism, DayNight, feature_number)%>%
mutate(T0 = mean(T0, na.rm = TRUE))%>%
mutate(log2_change = log2(TF/T0))%>%
ungroup()
View(log2_change_vals)
# GRAPHING -- NOSC Vs. dG plot --------------------------------------------
nosc_plot <- log2_change_vals%>%
filter(DayNight == "Day")%>%
group_by(feature_number, Organism)%>%
summarize_if(is.numeric, mean)%>%
ungroup()%>%
left_join(osm_dunnetts%>%
select(feature_number, CF_superclass), by = "feature_number")%>%
left_join(networking%>%
select(feature_number, dG, NOSC, N, O), by = "feature_number")%>%
left_join(metadata%>%
select(feature_number, `row m/z`, `row retention time`), by = "feature_number")
View(nosc_plot)
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
ggplot(aes(dG, NOSC, color = log2_change)) +
# ggplot(aes(`row m/z`, NOSC, color = log2_change)) +
geom_smooth(method = lm, color = 'grey') +
geom_point(stat = "identity") +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient(low = '#EBCC2A', high = '#3B9AB2')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(dG, log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient(low = '#EBCC2A', high = '#3B9AB2')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row m/z`, dG, color = log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient(low = '#EBCC2A', high = '#3B9AB2')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
ggplot(aes(dG, NOSC, color = log2_change)) +
# ggplot(aes(`row m/z`, NOSC, color = log2_change)) +
geom_smooth(method = lm, color = 'grey') +
geom_point(stat = "identity") +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass)
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row m/z`, dG, color = log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient(low='#E1FA72', high='#F46FEE')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row m/z`, dG, color = log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient(low='red', high='#5011D1')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row m/z`, dG, color = log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient(low='white', high='#5011D1')
dev.off()
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row m/z`, dG, color = log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient(low='white', high='#5011D1')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row m/z`, dG, color = log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient(low='grey', high='#5011D1')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row m/z`, dG, color = log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient(low='#5011D1', high='grey')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row m/z`, dG, color = log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient(low='#5011D1', high='grey')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row m/z`, dG, color = log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey' high='red')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row m/z`, dG, color = log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
nosc_plot%>%
# filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row m/z`, dG, color = log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row m/z`, dG, color = log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
ggplot(aes(dG, NOSC, color = log2_change)) +
# ggplot(aes(`row m/z`, NOSC, color = log2_change)) +
geom_smooth(method = lm, color = 'grey') +
geom_point(stat = "identity") +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass)
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
ggplot(aes(dG, NOSC, color = log2_change)) +
# ggplot(aes(`row m/z`, NOSC, color = log2_change)) +
geom_smooth(method = lm, color = 'grey') +
geom_point(stat = "identity") +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(dG, log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
)
x = c(1:5)
y = c(2,4,5,4,5)
df = as.data.frame(x)
df
df.y = y
df
df = as.data.frame(x)%>%
mutate(y = y)
df
b = sum(diff_x*diff_y)/sum(diff_x)
df = as.data.frame(x)%>%
mutate(y = y,
diff_x = x - mean(x),
diff_y = y - mean(y))
b = sum(df.diff_x*df.diff_y)/sum(df.diff_x)
df
b = sum(df$diff_x*df$diff_y)/sum(df$diff_x)
b
sum(df$diff_x*df$diff_y)
sum(df$diff_x)
b = sum(df$diff_x*df$diff_y)/sum((df$diff_x)^2)
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row retentiuon time`, dG, color = log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row retention time`, dG, color = log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row retention time`, dG, color = log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
pdf('plots/craig_lability.pdf', width = 6, height = 5)
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
ggplot(aes(dG, NOSC, color = log2_change)) +
# ggplot(aes(`row m/z`, NOSC, color = log2_change)) +
geom_smooth(method = lm, color = 'grey') +
geom_point(stat = "identity") +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(dG, log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row m/z`, dG, color = log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row retention time`, dG, color = log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
dev.off()
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row m/z`, log2_change)) +
geom_smooth(method = lm, color = 'grey') +
geom_point(stat = "identity") +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
geom_smooth(method = lm, color = 'grey') +
ggplot(aes(`row m/z`, log2_change)) +
geom_point(stat = "identity") +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row m/z`, log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
# GRAPHING -- NOSC Vs. dG plot --------------------------------------------
nosc_plot <- log2_change_vals%>%
filter(DayNight == "Day")%>%
group_by(feature_number, Organism)%>%
summarize_if(is.numeric, mean)%>%
ungroup()%>%
filter(feature_number %in% osm_dunnett_features)%>%
left_join(osm_dunnetts%>%
select(feature_number, CF_superclass), by = "feature_number")%>%
left_join(networking%>%
select(feature_number, dG, NOSC, N, O), by = "feature_number")%>%
left_join(metadata%>%
select(feature_number, `row m/z`, `row retention time`), by = "feature_number")
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row m/z`, log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
# GRAPHING -- NOSC Vs. dG plot --------------------------------------------
nosc_plot <- log2_change_vals%>%
filter(DayNight == "Day")%>%
group_by(feature_number, Organism)%>%
summarize_if(is.numeric, mean)%>%
ungroup()%>%
filter(feature_number %in% osm_dunnett_features)%>%
left_join(osm_dunnetts%>%
select(feature_number, CF_superclass), by = "feature_number")%>%
left_join(networking%>%
select(feature_number, dG, NOSC, N, O), by = "feature_number")%>%
left_join(metadata%>%
select(feature_number, `row m/z`, `row retention time`), by = "feature_number")
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row m/z`, log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
log2_change_vals <- feature_table_no_back_trans%>%
gather(sample_name, xic, 2:ncol(.))%>%
ungroup()%>%
separate(sample_name, c("Experiment", "Organism", "Replicate", "Timepoint"), sep = "_")%>%
filter(!Experiment %like% "%Blank%",
!Organism %like% "%Blank")%>%
mutate(Experiment = case_when(Experiment == "D" ~ "dorcierr",
Experiment == "M" ~ "mordor",
Experiment == "R" ~ "RR3",
TRUE ~ as.character(Experiment)),
Organism = case_when(Organism == "CC" ~ "CCA",
Organism == "DT" ~ "Dictyota",
Organism == "PL" ~ "Porites lobata",
Organism == "PV" ~ "Pocillopora verrucosa",
Organism == "TR" ~ "Turf",
Organism == "WA" ~ "Water control",
TRUE ~ as.character(Organism)))%>%
separate(Timepoint, c("Timepoint", "DayNight"), sep = 2)%>%
mutate(DayNight = case_when(DayNight == "D" ~ "Day",
TRUE ~ "Night"),
xic = case_when(xic == 0 ~ 1000,
TRUE ~ as.numeric(xic)))%>%
group_by(Organism, Timepoint, DayNight, feature_number)%>%
mutate(Replicate = as.numeric(Replicate),
xic = case_when(sum(xic) == 4000 ~ xic + Replicate,
sum(xic) == 2000 ~ xic + Replicate,
TRUE ~ as.numeric(xic)))%>%
ungroup()%>%
spread(Timepoint, xic)%>%
group_by(Organism, DayNight, feature_number)%>%
mutate(T0 = mean(T0, na.rm = TRUE))%>%
mutate(log2_change = log2(TF/T0))%>%
filter(log2_change >= 3.3 | log2_change <= -3.3)%>%
ungroup()
# GRAPHING -- NOSC Vs. dG plot --------------------------------------------
nosc_plot <- log2_change_vals%>%
filter(DayNight == "Day")%>%
group_by(feature_number, Organism)%>%
summarize_if(is.numeric, mean)%>%
ungroup()%>%
filter(feature_number %in% osm_dunnett_features)%>%
left_join(osm_dunnetts%>%
select(feature_number, CF_superclass), by = "feature_number")%>%
left_join(networking%>%
select(feature_number, dG, NOSC, N, O), by = "feature_number")%>%
left_join(metadata%>%
select(feature_number, `row m/z`, `row retention time`), by = "feature_number")
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row m/z`, log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
log2_change_vals <- feature_table_no_back_trans%>%
gather(sample_name, xic, 2:ncol(.))%>%
ungroup()%>%
separate(sample_name, c("Experiment", "Organism", "Replicate", "Timepoint"), sep = "_")%>%
filter(!Experiment %like% "%Blank%",
!Organism %like% "%Blank")%>%
mutate(Experiment = case_when(Experiment == "D" ~ "dorcierr",
Experiment == "M" ~ "mordor",
Experiment == "R" ~ "RR3",
TRUE ~ as.character(Experiment)),
Organism = case_when(Organism == "CC" ~ "CCA",
Organism == "DT" ~ "Dictyota",
Organism == "PL" ~ "Porites lobata",
Organism == "PV" ~ "Pocillopora verrucosa",
Organism == "TR" ~ "Turf",
Organism == "WA" ~ "Water control",
TRUE ~ as.character(Organism)))%>%
separate(Timepoint, c("Timepoint", "DayNight"), sep = 2)%>%
mutate(DayNight = case_when(DayNight == "D" ~ "Day",
TRUE ~ "Night"),
xic = case_when(xic == 0 ~ 1000,
TRUE ~ as.numeric(xic)))%>%
group_by(Organism, Timepoint, DayNight, feature_number)%>%
mutate(Replicate = as.numeric(Replicate),
xic = case_when(sum(xic) == 4000 ~ xic + Replicate,
sum(xic) == 2000 ~ xic + Replicate,
TRUE ~ as.numeric(xic)))%>%
ungroup()%>%
spread(Timepoint, xic)%>%
group_by(Organism, DayNight, feature_number)%>%
mutate(T0 = mean(T0, na.rm = TRUE))%>%
mutate(log2_change = log2(TF/T0))%>%
filter(log2_change <= -3.3)%>%
ungroup()
# GRAPHING -- NOSC Vs. dG plot --------------------------------------------
nosc_plot <- log2_change_vals%>%
filter(DayNight == "Day")%>%
group_by(feature_number, Organism)%>%
summarize_if(is.numeric, mean)%>%
ungroup()%>%
filter(feature_number %in% osm_dunnett_features)%>%
left_join(osm_dunnetts%>%
select(feature_number, CF_superclass), by = "feature_number")%>%
left_join(networking%>%
select(feature_number, dG, NOSC, N, O), by = "feature_number")%>%
left_join(metadata%>%
select(feature_number, `row m/z`, `row retention time`), by = "feature_number")
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row m/z`, log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row m/z`, dG)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(dG, log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(`row m/z`, log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(T0, log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
nosc_plot%>%
filter(CF_superclass %like any% c('Alkaloids%', 'Benzen%', 'Lipids%', 'no matches', 'Organic acid%', '%hetero%', '%propan%'))%>%
# ggplot(aes(dG, NOSC, color = log2_change)) +
ggplot(aes(log10(T0), log2_change)) +
geom_point(stat = "identity") +
geom_smooth(method = lm, color = 'grey') +
# xlim(c(125, 750)) +
facet_wrap(~CF_superclass) +
scale_color_gradient2(low='#5011D1', mid = 'grey', high='red')
