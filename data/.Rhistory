by = 'feature_number')%>%
mutate(net_act = case_when(network == -1 ~ -as.numeric(feature_number),
TRUE ~ network))%>%
left_join(all_activity, by = c('net_act', 'DayNight'))%>%
select(feature_number, network, activity, Organism, Replicate, DayNight, everything())%>%
select(-net_act)
linda_sum <- linda_df%>%
group_by(Organism, activity, Replicate, DayNight)%>%
summarize_if(is.numeric, sum)%>%
ungroup()%>%
select(-log2_change)%>%
gather(Timepoint, xic, T0:TF)%>%
group_by(Organism, activity, Timepoint, DayNight)%>%
mutate(err = sd(xic))%>%
# summarize_if(is.numeric, mean, na.rm = TRUE)%>%
ungroup()%>%
unite(org_activity, c('Organism', 'activity'), sep = ' / ', remove = FALSE)%>%
mutate(shape = case_when(Timepoint == 'T0' ~ 'T0',
Timepoint == 'TF' & activity == 'depletolite' ~ 'TF depletion',
Timepoint == 'TF' & activity == 'accumolite' ~ 'TF accumulation',
Timepoint == 'TF' & activity == 'recalcitrant' & Organism == 'Turf' ~ 'accumulation',
TRUE ~ 'TF depletion'))%>%
group_by(Organism, Replicate, Timepoint)%>%
mutate(ra = xic/sum(xic, na.rm = TRUE))%>%
ungroup()
# png("./plots/change_xic_activity.png", width = 1500, height = 1000)
# linda_sum%>%
#   # filter(activity != 'recalcitrant')%>%
#   mutate(log10 = log10(xic))%>%
#   ggplot(aes(ra, org_activity, color = Organism, shape = shape)) +
#   geom_point(stat = 'identity', size = 14, alpha = 0.45) +
#   # geom_errorbarh(aes(xmin = xic - err, xmax = xic + err)) +
#   geom_line(aes(group = org_activity)) +
#   scale_color_manual(values = org_colors_no_water) +
#   scale_shape_manual(values = c("\u25A0", "\u25C4", "\u25BA")) +
#   labs(x = 'Relative Abundance', y = 'Organism / Activity') +
#   # scale_x_log10() +
#   # facet_wrap(~activity, nrow = 3) +
#   theme(axis.line = element_blank(),
#         axis.text = element_text(size = 20),
#         axis.ticks = element_blank(),
#         legend.background = element_rect(fill = "transparent"), # get rid of legend bg
#         legend.box.background = element_blank(),
#         panel.background = element_rect(fill = "transparent"), # bg of the panel
#         plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
#         strip.text = element_text(size=20),
#         legend.text = element_text(size = 20),
#         legend.title = element_text(size = 20),
#         legend.position = 'none',
#         title = element_text(size = 40, hjust = 0.5),
#         plot.title = element_text(hjust = 0.5, vjust = 3),
#         strip.background = element_blank())
linda_mean_diff <- linda_sum%>%
select(-c(err:ra))%>%
group_by(org_activity, Organism, activity)%>%
mutate(x_val = max(xic, na.rm = TRUE))%>%
ungroup()%>%
group_by(org_activity, Organism, activity, Timepoint)%>%
summarize_if(is.numeric, mean, na.rm = TRUE)%>%
ungroup()%>%
spread(Timepoint, xic)%>%
mutate(difference = TF-T0)%>%
filter(activity != 'recalcitrant')
png("./plots/change_xic_activity.png", width = 1600, height = 1000)
linda_sum%>%
filter(activity != 'recalcitrant')%>%
mutate(log10 = log10(xic))%>%
ggplot(aes(xic, org_activity, color = Organism, shape = shape)) +
geom_point(stat = 'identity', size = 14, alpha = 0.45) +
# geom_errorbarh(aes(xmin = xic - err, xmax = xic + err)) +
geom_line(aes(group = org_activity)) +
geom_text(data = linda_mean_diff, aes(x = x_val, y = org_activity,
label = formatC(difference, format = 'e', digits = 2),
shape = NULL), vjust = -1, size = 7) +
scale_color_manual(values = org_colors_no_water) +
scale_shape_manual(values = c("\u25A0", "\u25BA", "\u25C4")) +
labs(x = 'Sum Intensity (xic)', y = 'Organism / Metabolite pool', color = 'Organism: ', shape = 'Sample:') +
# xlim(0,0.3) +
# scale_x_log10() +
# facet_wrap(~activity, nrow = 3) +
theme(axis.line = element_blank(),
axis.text = element_text(size = 20),
axis.ticks = element_blank(),
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_blank(),
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
strip.text = element_text(size= 25),
legend.text = element_text(size = 25),
legend.title = element_text(size = 25),
legend.position = 'top',
title = element_text(size = 40, hjust = 0.5),
plot.title = element_text(hjust = 0.5, vjust = 3),
strip.background = element_blank()) +
guides(color = guide_legend(nrow=2, byrow=TRUE),
shape = guide_legend(nrow=2, byrow=TRUE))
dev.off()
# linda_split <- linda_df%>%
#   group_by(Organism)%>%
#   split(.$Organism)
# list2env(linda_split, globalenv())
#
# write_csv(`Pocillopora verrucosa`, '~/Documents/SDSU_Scripps/DORCIERR/Datasets/linda_features_pocillopora.csv')
# write_csv(`Porites lobata`, '~/Documents/SDSU_Scripps/DORCIERR/Datasets/linda_features_porites.csv')
# write_csv(`CCA`, '~/Documents/SDSU_Scripps/DORCIERR/Datasets/linda_features_cca.csv')
# write_csv(`Turf`, '~/Documents/SDSU_Scripps/DORCIERR/Datasets/linda_features_turf.csv')
# write_csv(`Dictyota`, '~/Documents/SDSU_Scripps/DORCIERR/Datasets/linda_features_dictyota.csv')
linda_sum%>%
filter(activity != 'recalcitrant')%>%
mutate(log10 = log10(xic))%>%
ggplot(aes(xic, org_activity, color = Organism, shape = shape)) +
geom_point(stat = 'identity', size = 14, alpha = 0.45) +
# geom_errorbarh(aes(xmin = xic - err, xmax = xic + err)) +
geom_line(aes(group = org_activity)) +
geom_text(data = linda_mean_diff, aes(x = x_val, y = org_activity,
label = formatC(difference, format = 'e', digits = 2),
shape = NULL), vjust = -1, size = 7) +
scale_color_manual(values = org_colors_no_water) +
scale_shape_manual(values = c("\u25A0", "\u25BA", "\u25C4")) +
labs(x = 'Sum Intensity (xic)', y = 'Organism / Metabolite pool', color = 'Organism: ', shape = 'Sample:') +
# xlim(0,0.3) +
# scale_x_log10() +
# facet_wrap(~activity, nrow = 3) +
theme(axis.line = element_blank(),
axis.text = element_text(size = 20),
axis.ticks = element_blank(),
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_blank(),
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
strip.text = element_text(size= 25),
legend.text = element_text(size = 25),
legend.title = element_text(size = 25),
legend.position = 'top',
title = element_text(size = 40, hjust = 0.5),
plot.title = element_text(hjust = 0.5, vjust = 3),
strip.background = element_blank()) +
guides(color = guide_legend(nrow=2, byrow=TRUE),
shape = guide_legend(nrow=2, byrow=TRUE))
linda_sum%>%
filter(activity != 'recalcitrant')%>%
mutate(log10 = log10(xic))%>%
ggplot(aes(xic, org_activity, color = Organism, shape = shape)) +
geom_point(stat = 'identity', size = 14, alpha = 0.45) +
# geom_errorbarh(aes(xmin = xic - err, xmax = xic + err)) +
geom_line(aes(group = org_activity)) +
geom_text(data = linda_mean_diff, aes(x = x_val, y = org_activity,
label = formatC(difference, format = 'e', digits = 2),
shape = NULL), vjust = -1, size = 7) +
facet_wrap(~activity, nrow = 2) +
scale_color_manual(values = org_colors_no_water) +
scale_shape_manual(values = c("\u25A0", "\u25BA", "\u25C4")) +
labs(x = 'Sum Intensity (xic)', y = 'Organism / Metabolite pool', color = 'Organism: ', shape = 'Sample:') +
# xlim(0,0.3) +
# scale_x_log10() +
# facet_wrap(~activity, nrow = 3) +
theme(axis.line = element_blank(),
axis.text = element_text(size = 20),
axis.ticks = element_blank(),
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_blank(),
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
strip.text = element_text(size= 25),
legend.text = element_text(size = 25),
legend.title = element_text(size = 25),
legend.position = 'top',
title = element_text(size = 40, hjust = 0.5),
plot.title = element_text(hjust = 0.5, vjust = 3),
strip.background = element_blank()) +
guides(color = guide_legend(nrow=2, byrow=TRUE),
shape = guide_legend(nrow=2, byrow=TRUE))
linda_sum%>%
filter(activity != 'recalcitrant')%>%
mutate(log10 = log10(xic))%>%
ggplot(aes(xic, org_activity, color = Organism, shape = shape)) +
geom_point(stat = 'identity', size = 14, alpha = 0.45) +
# geom_errorbarh(aes(xmin = xic - err, xmax = xic + err)) +
geom_line(aes(group = org_activity)) +
geom_text(data = linda_mean_diff, aes(x = x_val, y = org_activity,
label = formatC(difference, format = 'e', digits = 2),
shape = NULL), vjust = -1, size = 7) +
facet_wrap(~activity, nrow = 2, scales = 'free') +
scale_color_manual(values = org_colors_no_water) +
scale_shape_manual(values = c("\u25A0", "\u25BA", "\u25C4")) +
labs(x = 'Sum Intensity (xic)', y = 'Organism / Metabolite pool', color = 'Organism: ', shape = 'Sample:') +
# xlim(0,0.3) +
# scale_x_log10() +
# facet_wrap(~activity, nrow = 3) +
theme(axis.line = element_blank(),
axis.text = element_text(size = 20),
axis.ticks = element_blank(),
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_blank(),
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
strip.text = element_text(size= 25),
legend.text = element_text(size = 25),
legend.title = element_text(size = 25),
legend.position = 'top',
title = element_text(size = 40, hjust = 0.5),
plot.title = element_text(hjust = 0.5, vjust = 3),
strip.background = element_blank()) +
guides(color = guide_legend(nrow=2, byrow=TRUE),
shape = guide_legend(nrow=2, byrow=TRUE))
linda_sum%>%
filter(activity != 'recalcitrant')%>%
mutate(log10 = log10(xic))%>%
ggplot(aes(xic, Organism, color = Organism, shape = shape)) +
geom_point(stat = 'identity', size = 14, alpha = 0.45) +
# geom_errorbarh(aes(xmin = xic - err, xmax = xic + err)) +
geom_line(aes(group = org_activity)) +
geom_text(data = linda_mean_diff, aes(x = x_val, y = org_activity,
label = formatC(difference, format = 'e', digits = 2),
shape = NULL), vjust = -1, size = 7) +
facet_wrap(~activity, nrow = 1, scales = 'free') +
scale_color_manual(values = org_colors_no_water) +
scale_shape_manual(values = c("\u25A0", "\u25BA", "\u25C4")) +
labs(x = 'Sum Intensity (xic)', y = 'Organism / Metabolite pool', color = 'Organism: ', shape = 'Sample:') +
# xlim(0,0.3) +
# scale_x_log10() +
# facet_wrap(~activity, nrow = 3) +
theme(axis.line = element_blank(),
axis.text = element_text(size = 20),
axis.ticks = element_blank(),
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_blank(),
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
strip.text = element_text(size= 25),
legend.text = element_text(size = 25),
legend.title = element_text(size = 25),
legend.position = 'top',
title = element_text(size = 40, hjust = 0.5),
plot.title = element_text(hjust = 0.5, vjust = 3),
strip.background = element_blank()) +
guides(color = guide_legend(nrow=2, byrow=TRUE),
shape = guide_legend(nrow=2, byrow=TRUE))
linda_sum%>%
filter(activity != 'recalcitrant')%>%
mutate(log10 = log10(xic))%>%
ggplot(aes(xic, Organism, color = Organism, shape = shape)) +
geom_point(stat = 'identity', size = 14, alpha = 0.45) +
# geom_errorbarh(aes(xmin = xic - err, xmax = xic + err)) +
geom_line(aes(group = Organism)) +
geom_text(data = linda_mean_diff, aes(x = x_val, y = Organism,
label = formatC(difference, format = 'e', digits = 2),
shape = NULL), vjust = -1, size = 7) +
facet_wrap(~activity, nrow = 1, scales = 'free') +
scale_color_manual(values = org_colors_no_water) +
scale_shape_manual(values = c("\u25A0", "\u25BA", "\u25C4")) +
labs(x = 'Sum Intensity (xic)', y = 'Organism / Metabolite pool', color = 'Organism: ', shape = 'Sample:') +
# xlim(0,0.3) +
# scale_x_log10() +
# facet_wrap(~activity, nrow = 3) +
theme(axis.line = element_blank(),
axis.text = element_text(size = 20),
axis.ticks = element_blank(),
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_blank(),
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
strip.text = element_text(size= 25),
legend.text = element_text(size = 25),
legend.title = element_text(size = 25),
legend.position = 'top',
title = element_text(size = 40, hjust = 0.5),
plot.title = element_text(hjust = 0.5, vjust = 3),
strip.background = element_blank()) +
guides(color = guide_legend(nrow=2, byrow=TRUE),
shape = guide_legend(nrow=2, byrow=TRUE))
linda_sum%>%
filter(activity != 'recalcitrant')%>%
mutate(log10 = log10(xic))%>%
ggplot(aes(xic, Organism, color = Organism, shape = shape)) +
geom_point(stat = 'identity', size = 14, alpha = 0.45) +
# geom_errorbarh(aes(xmin = xic - err, xmax = xic + err)) +
geom_line(aes(group = Organism)) +
geom_text(data = linda_mean_diff, aes(x = x_val, y = Organism,
label = formatC(difference, format = 'e', digits = 2),
shape = NULL), vjust = -1, size = 7) +
facet_wrap(~activity, nrow = 1, scales = 'free_x') +
scale_color_manual(values = org_colors_no_water) +
scale_shape_manual(values = c("\u25A0", "\u25BA", "\u25C4")) +
labs(x = 'Sum Intensity (xic)', y = 'Organism / Metabolite pool', color = 'Organism: ', shape = 'Sample:') +
# xlim(0,0.3) +
# scale_x_log10() +
# facet_wrap(~activity, nrow = 3) +
theme(axis.line = element_blank(),
axis.text = element_text(size = 20),
axis.ticks = element_blank(),
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_blank(),
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
strip.text = element_text(size= 25),
legend.text = element_text(size = 25),
legend.title = element_text(size = 25),
legend.position = 'top',
title = element_text(size = 40, hjust = 0.5),
plot.title = element_text(hjust = 0.5, vjust = 3),
strip.background = element_blank()) +
guides(color = guide_legend(nrow=2, byrow=TRUE),
shape = guide_legend(nrow=2, byrow=TRUE))
png("./plots/change_xic_activity.png", width = 1600, height = 1000)
linda_sum%>%
filter(activity != 'recalcitrant')%>%
mutate(log10 = log10(xic))%>%
ggplot(aes(xic, Organism, color = Organism, shape = shape)) +
geom_point(stat = 'identity', size = 14, alpha = 0.45) +
# geom_errorbarh(aes(xmin = xic - err, xmax = xic + err)) +
geom_line(aes(group = Organism)) +
geom_text(data = linda_mean_diff, aes(x = x_val, y = Organism,
label = formatC(difference, format = 'e', digits = 2),
shape = NULL), vjust = -1, size = 7) +
facet_wrap(~activity, nrow = 1, scales = 'free_x') +
scale_color_manual(values = org_colors_no_water) +
scale_shape_manual(values = c("\u25A0", "\u25BA", "\u25C4")) +
labs(x = 'Sum Intensity (xic)', y = 'Organism / Metabolite pool', color = 'Organism: ', shape = 'Sample:') +
# xlim(0,0.3) +
# scale_x_log10() +
# facet_wrap(~activity, nrow = 3) +
theme(axis.line = element_blank(),
axis.text = element_text(size = 20),
axis.ticks = element_blank(),
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_blank(),
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
strip.text = element_text(size= 25),
legend.text = element_text(size = 25),
legend.title = element_text(size = 25),
legend.position = 'top',
title = element_text(size = 40, hjust = 0.5),
plot.title = element_text(hjust = 0.5, vjust = 3),
strip.background = element_blank()) +
guides(color = guide_legend(nrow=2, byrow=TRUE),
shape = guide_legend(nrow=2, byrow=TRUE))
dev.off()
png("./plots/change_xic_activity.png", width = 2000, height = 1000)
linda_sum%>%
filter(activity != 'recalcitrant')%>%
mutate(log10 = log10(xic))%>%
ggplot(aes(xic, Organism, color = Organism, shape = shape)) +
geom_point(stat = 'identity', size = 14, alpha = 0.45) +
# geom_errorbarh(aes(xmin = xic - err, xmax = xic + err)) +
geom_line(aes(group = Organism)) +
geom_text(data = linda_mean_diff, aes(x = x_val, y = Organism,
label = formatC(difference, format = 'e', digits = 2),
shape = NULL), vjust = -1, size = 7) +
facet_wrap(~activity, nrow = 1, scales = 'free_x') +
scale_color_manual(values = org_colors_no_water) +
scale_shape_manual(values = c("\u25A0", "\u25BA", "\u25C4")) +
labs(x = 'Sum Intensity (xic)', y = 'Organism / Metabolite pool', color = 'Organism: ', shape = 'Sample:') +
# xlim(0,0.3) +
# scale_x_log10() +
# facet_wrap(~activity, nrow = 3) +
theme(axis.line = element_blank(),
axis.text = element_text(size = 20),
axis.ticks = element_blank(),
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_blank(),
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
strip.text = element_text(size= 25),
legend.text = element_text(size = 25),
legend.title = element_text(size = 25),
legend.position = 'top',
title = element_text(size = 40, hjust = 0.5),
plot.title = element_text(hjust = 0.5, vjust = 3),
strip.background = element_blank()) +
guides(color = guide_legend(nrow=2, byrow=TRUE),
shape = guide_legend(nrow=2, byrow=TRUE))
dev.off()
linda_sum%>%
filter(activity != 'recalcitrant')%>%
mutate(log10 = log10(xic))%>%
ggplot(aes(xic, Organism, color = Organism, shape = shape)) +
geom_point(stat = 'identity', size = 14, alpha = 0.45) +
# geom_errorbarh(aes(xmin = xic - err, xmax = xic + err)) +
geom_line(aes(group = Organism)) +
geom_text(data = linda_mean_diff, aes(x = x_val, y = Organism,
label = formatC(difference, format = 'e', digits = 2),
shape = NULL), vjust = -1, size = 7) +
facet_wrap(~activity, nrow = 1, scales = 'free_x') +
scale_color_manual(values = org_colors_no_water) +
scale_shape_manual(values = c("\u25A0", "\u25BA", "\u25C4")) +
labs(x = 'Sum Intensity (xic)', y = 'Organism / Metabolite pool', color = 'Organism: ', shape = 'Sample:') +
# xlim(0,0.3) +
# scale_x_log10() +
# facet_wrap(~activity, nrow = 3) +
theme(axis.line = element_blank(),
axis.text = element_text(size = 20),
axis.ticks = element_blank(),
axis.text.x = element_text(angle = 60, hjust = 1),
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_blank(),
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
strip.text = element_text(size= 25),
legend.text = element_text(size = 25),
legend.title = element_text(size = 25),
legend.position = 'top',
title = element_text(size = 40, hjust = 0.5),
plot.title = element_text(hjust = 0.5, vjust = 3),
strip.background = element_blank()) +
guides(color = guide_legend(nrow=2, byrow=TRUE),
shape = guide_legend(nrow=2, byrow=TRUE))
linda_sum%>%
filter(activity != 'recalcitrant')%>%
mutate(log10 = log10(xic))%>%
ggplot(aes(xic, Organism, color = Organism, shape = shape)) +
geom_point(stat = 'identity', size = 14, alpha = 0.45) +
# geom_errorbarh(aes(xmin = xic - err, xmax = xic + err)) +
geom_line(aes(group = Organism)) +
geom_text(data = linda_mean_diff, aes(x = x_val, y = Organism,
label = formatC(difference, format = 'e', digits = 2),
shape = NULL), vjust = -1, size = 7) +
facet_wrap(~activity, nrow = 1, scales = 'free_x') +
scale_color_manual(values = org_colors_no_water) +
scale_shape_manual(values = c("\u25A0", "\u25BA", "\u25C4")) +
labs(x = 'Sum Intensity (xic)', y = 'Organism / Metabolite pool', color = 'Organism: ', shape = 'Sample:') +
# xlim(0,0.3) +
# scale_x_log10() +
# facet_wrap(~activity, nrow = 3) +
theme(axis.line = element_blank(),
axis.text = element_text(size = 20),
axis.ticks = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_blank(),
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
strip.text = element_text(size= 25),
legend.text = element_text(size = 25),
legend.title = element_text(size = 25),
legend.position = 'top',
title = element_text(size = 40, hjust = 0.5),
plot.title = element_text(hjust = 0.5, vjust = 3),
strip.background = element_blank()) +
guides(color = guide_legend(nrow=2, byrow=TRUE),
shape = guide_legend(nrow=2, byrow=TRUE))
linda_sum%>%
filter(activity != 'recalcitrant')%>%
mutate(log10 = log10(xic))%>%
ggplot(aes(xic, Organism, color = Organism, shape = shape)) +
geom_point(stat = 'identity', size = 14, alpha = 0.45) +
# geom_errorbarh(aes(xmin = xic - err, xmax = xic + err)) +
geom_line(aes(group = Organism)) +
geom_text(data = linda_mean_diff, aes(x = x_val, y = Organism,
label = formatC(difference, format = 'e', digits = 2),
shape = NULL), vjust = -1, size = 7) +
facet_wrap(~activity, nrow = 1, scales = 'free_x') +
scale_color_manual(values = org_colors_no_water) +
scale_shape_manual(values = c("\u25A0", "\u25BA", "\u25C4")) +
labs(x = 'Sum Intensity (xic)', y = 'Organism / Metabolite pool', color = 'Organism: ', shape = 'Sample:') +
# xlim(0,0.3) +
# scale_x_log10() +
# facet_wrap(~activity, nrow = 3) +
theme(axis.line = element_blank(),
axis.text = element_text(size = 20),
axis.ticks = element_blank(),
axis.text.x = element_text(angle = 30, hjust = 1),
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_blank(),
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
strip.text = element_text(size= 25),
legend.text = element_text(size = 25),
legend.title = element_text(size = 25),
legend.position = 'top',
title = element_text(size = 40, hjust = 0.5),
plot.title = element_text(hjust = 0.5, vjust = 3),
strip.background = element_blank()) +
guides(color = guide_legend(nrow=2, byrow=TRUE),
shape = guide_legend(nrow=2, byrow=TRUE))
png("./plots/change_xic_activity.png", width = 2000, height = 1000)
linda_sum%>%
filter(activity != 'recalcitrant')%>%
mutate(log10 = log10(xic))%>%
ggplot(aes(xic, Organism, color = Organism, shape = shape)) +
geom_point(stat = 'identity', size = 14, alpha = 0.45) +
# geom_errorbarh(aes(xmin = xic - err, xmax = xic + err)) +
geom_line(aes(group = Organism)) +
geom_text(data = linda_mean_diff, aes(x = x_val, y = Organism,
label = formatC(difference, format = 'e', digits = 2),
shape = NULL), vjust = -1, size = 7) +
facet_wrap(~activity, nrow = 1, scales = 'free_x') +
scale_color_manual(values = org_colors_no_water) +
scale_shape_manual(values = c("\u25A0", "\u25BA", "\u25C4")) +
labs(x = 'Sum Intensity (xic)', y = 'Organism / Metabolite pool', color = 'Organism: ', shape = 'Sample:') +
# xlim(0,0.3) +
# scale_x_log10() +
# facet_wrap(~activity, nrow = 3) +
theme(axis.line = element_blank(),
axis.text = element_text(size = 20),
axis.ticks = element_blank(),
axis.text.x = element_text(angle = 30, hjust = 1),
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_blank(),
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
strip.text = element_text(size= 25),
legend.text = element_text(size = 25),
legend.title = element_text(size = 25),
legend.position = 'top',
title = element_text(size = 40, hjust = 0.5),
plot.title = element_text(hjust = 0.5, vjust = 3),
strip.background = element_blank()) +
guides(color = guide_legend(nrow=2, byrow=TRUE),
shape = guide_legend(nrow=2, byrow=TRUE))
dev.off()
