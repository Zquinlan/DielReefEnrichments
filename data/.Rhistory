TRUE ~ "Cosmo"))))%>%
unnest(data)
t_test_features <- compound_prevalance%>%
left_join(networking, by = "feature_number")
grouped_t_test_features <- t_test_features%>%
group_by(exudate_type, DayNight, activity)%>%
nest()
mutate(exudate_type = case_when(is.na(CCA) == FALSE &
is.na(Dictyota) &
is.na(Turf) &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "CCA",
is.na(CCA)  &
is.na(Dictyota) == FALSE &
is.na(Turf) &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "Dictyota",
is.na(CCA)  &
is.na(Dictyota) &
is.na(Turf) == FALSE &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "Turf",
is.na(CCA) &
is.na(Dictyota) &
is.na(Turf) &
is.na(`Pocillopora verrucosa`) == FALSE &
is.na(`Porites lobata`) ~ "Pocillopora verrucosa",
is.na(CCA) &
is.na(Dictyota) &
is.na(Turf) &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) == FALSE ~ "Porites lobata",
is.na(`Pocillopora verrucosa`) == FALSE &
is.na(CCA) == FALSE &
is.na(Dictyota) &
is.na(Turf)  |
is.na(`Porites lobata`) == FALSE &
is.na(CCA) == FALSE &
is.na(Dictyota) &
is.na(Turf) ~ "Corraline",
is.na(`Pocillopora verrucosa`) &
is.na(CCA) == FALSE &
is.na(Dictyota) == FALSE &
is.na(`Porites lobata`) |
is.na(CCA) == FALSE &
is.na(Turf) == FALSE &
is.na(`Porites lobata`) &
is.na(`Pocillopora verrucosa`) ~ "Algae",
is.na(`Dictyota`) &
is.na(CCA)  &
is.na(Turf) &
is.na(`Porites lobata`) == FALSE &
is.na(`Pocillopora verrucosa`) == FALSE ~ "Coral",
is.na(`Dictyota`) == FALSE &
is.na(CCA)  &
is.na(Turf) == FALSE &
is.na(`Porites lobata`) &
is.na(`Pocillopora verrucosa`) ~ "Fleshy Algae",
is.na(CCA)  &
is.na(Dictyota) &
is.na(Turf) == FALSE &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "Turf",
number_exudate_organisms > 3 &
number_exudate_organisms < 6 ~ "Primary Producers",
number_exudate_organisms == 6 ~ "Planktonic",
TRUE ~ "Cosmo"))))%>%
unnest(data)
mutate(exudate_type = case_when(is.na(CCA) == FALSE &
is.na(Dictyota) &
is.na(Turf) &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "CCA",
is.na(CCA)  &
is.na(Dictyota) == FALSE &
is.na(Turf) &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "Dictyota",
is.na(CCA)  &
is.na(Dictyota) &
is.na(Turf) == FALSE &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "Turf",
is.na(CCA) &
is.na(Dictyota) &
is.na(Turf) &
is.na(`Pocillopora verrucosa`) == FALSE &
is.na(`Porites lobata`) ~ "Pocillopora verrucosa",
is.na(CCA) &
is.na(Dictyota) &
is.na(Turf) &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) == FALSE ~ "Porites lobata",
is.na(`Pocillopora verrucosa`) == FALSE &
is.na(CCA) == FALSE &
is.na(Dictyota) &
is.na(Turf)  |
is.na(`Porites lobata`) == FALSE &
is.na(CCA) == FALSE &
is.na(Dictyota) &
is.na(Turf) ~ "Corraline",
is.na(`Pocillopora verrucosa`) &
is.na(CCA) == FALSE &
is.na(Dictyota) == FALSE &
is.na(`Porites lobata`) |
is.na(CCA) == FALSE &
is.na(Turf) == FALSE &
is.na(`Porites lobata`) &
is.na(`Pocillopora verrucosa`) ~ "Algae",
is.na(`Dictyota`) &
is.na(CCA)  &
is.na(Turf) &
is.na(`Porites lobata`) == FALSE &
is.na(`Pocillopora verrucosa`) == FALSE ~ "Coral",
is.na(`Dictyota`) == FALSE &
is.na(CCA)  &
is.na(Turf) == FALSE &
is.na(`Porites lobata`) &
is.na(`Pocillopora verrucosa`) ~ "Fleshy Algae",
is.na(CCA)  &
is.na(Dictyota) &
is.na(Turf) == FALSE &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "Turf",
number_exudate_organisms > 3 &
number_exudate_organisms < 6 ~ "Primary Producers",
number_exudate_organisms == 6 ~ "Planktonic",
TRUE ~ "Cosmo"))))%>%
unnest(data)
mutate(exudate_type = case_when(is.na(CCA) == FALSE &
is.na(Dictyota) &
is.na(Turf) &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "CCA",
is.na(CCA)  &
is.na(Dictyota) == FALSE &
is.na(Turf) &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "Dictyota",
is.na(CCA)  &
is.na(Dictyota) &
is.na(Turf) == FALSE &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "Turf",
is.na(CCA) &
is.na(Dictyota) &
is.na(Turf) &
is.na(`Pocillopora verrucosa`) == FALSE &
is.na(`Porites lobata`) ~ "Pocillopora verrucosa",
is.na(CCA) &
is.na(Dictyota) &
is.na(Turf) &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) == FALSE ~ "Porites lobata",
is.na(`Pocillopora verrucosa`) == FALSE &
is.na(CCA) == FALSE &
is.na(Dictyota) &
is.na(Turf)  |
is.na(`Porites lobata`) == FALSE &
is.na(CCA) == FALSE &
is.na(Dictyota) &
is.na(Turf) ~ "Corraline",
is.na(`Pocillopora verrucosa`) &
is.na(CCA) == FALSE &
is.na(Dictyota) == FALSE &
is.na(`Porites lobata`) |
is.na(CCA) == FALSE &
is.na(Turf) == FALSE &
is.na(`Porites lobata`) &
is.na(`Pocillopora verrucosa`) ~ "Algae",
is.na(`Dictyota`) &
is.na(CCA)  &
is.na(Turf) &
is.na(`Porites lobata`) == FALSE &
is.na(`Pocillopora verrucosa`) == FALSE ~ "Coral",
is.na(`Dictyota`) == FALSE &
is.na(CCA)  &
is.na(Turf) == FALSE &
is.na(`Porites lobata`) &
is.na(`Pocillopora verrucosa`) ~ "Fleshy Algae",
is.na(CCA)  &
is.na(Dictyota) &
is.na(Turf) == FALSE &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "Turf",
number_exudate_organisms > 3 &
number_exudate_organisms < 6 ~ "Primary Producers",
number_exudate_organisms == 6 ~ "Planktonic",
TRUE ~ "Cosmo")))))%>%
unnest(data)
mutate(exudate_type = case_when(is.na(CCA) == FALSE &
is.na(Dictyota) &
is.na(Turf) &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "CCA",
is.na(CCA)  &
is.na(Dictyota) == FALSE &
is.na(Turf) &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "Dictyota",
is.na(CCA)  &
is.na(Dictyota) &
is.na(Turf) == FALSE &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "Turf",
is.na(CCA) &
is.na(Dictyota) &
is.na(Turf) &
is.na(`Pocillopora verrucosa`) == FALSE &
is.na(`Porites lobata`) ~ "Pocillopora verrucosa",
is.na(CCA) &
is.na(Dictyota) &
is.na(Turf) &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) == FALSE ~ "Porites lobata",
is.na(`Pocillopora verrucosa`) == FALSE &
is.na(CCA) == FALSE &
is.na(Dictyota) &
is.na(Turf)  |
is.na(`Porites lobata`) == FALSE &
is.na(CCA) == FALSE &
is.na(Dictyota) &
is.na(Turf) ~ "Corraline",
is.na(`Pocillopora verrucosa`) &
is.na(CCA) == FALSE &
is.na(Dictyota) == FALSE &
is.na(`Porites lobata`) |
is.na(CCA) == FALSE &
is.na(Turf) == FALSE &
is.na(`Porites lobata`) &
is.na(`Pocillopora verrucosa`) ~ "Algae",
is.na(`Dictyota`) &
is.na(CCA)  &
is.na(Turf) &
is.na(`Porites lobata`) == FALSE &
is.na(`Pocillopora verrucosa`) == FALSE ~ "Coral",
is.na(`Dictyota`) == FALSE &
is.na(CCA)  &
is.na(Turf) == FALSE &
is.na(`Porites lobata`) &
is.na(`Pocillopora verrucosa`) ~ "Fleshy Algae",
is.na(CCA)  &
is.na(Dictyota) &
is.na(Turf) == FALSE &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "Turf",
number_exudate_organisms > 3 &
number_exudate_organisms < 6 ~ "Primary Producers",
number_exudate_organisms == 6 ~ "Planktonic",
TRUE ~ "Cosmo")))%>%
unnest(data)
# META-STATS --Compounds prevalance ---------------------------------------
compound_prevalance <- t_pvals%>%
mutate(exudate_type = 1)%>%
mutate(fdr_mixed = case_when(FDR_greater < 0.05 ~ FDR_greater,
FDR_lesser < 0.05 ~ FDR_lesser))%>%
select(c(1:3, activity, fdr_mixed))%>%
group_by(DayNight, activity)%>%
nest()%>%
mutate(data = map(data, ~ spread(.x, Organism, fdr_mixed)%>%
add_column(number_exudate_organisms = rowSums(.[2:ncol(.)] >= 0, na.rm = TRUE))%>%
mutate(exudate_type = case_when(is.na(CCA) == FALSE &
is.na(Dictyota) &
is.na(Turf) &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "CCA",
is.na(CCA)  &
is.na(Dictyota) == FALSE &
is.na(Turf) &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "Dictyota",
is.na(CCA)  &
is.na(Dictyota) &
is.na(Turf) == FALSE &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "Turf",
is.na(CCA) &
is.na(Dictyota) &
is.na(Turf) &
is.na(`Pocillopora verrucosa`) == FALSE &
is.na(`Porites lobata`) ~ "Pocillopora verrucosa",
is.na(CCA) &
is.na(Dictyota) &
is.na(Turf) &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) == FALSE ~ "Porites lobata",
is.na(`Pocillopora verrucosa`) == FALSE &
is.na(CCA) == FALSE &
is.na(Dictyota) &
is.na(Turf)  |
is.na(`Porites lobata`) == FALSE &
is.na(CCA) == FALSE &
is.na(Dictyota) &
is.na(Turf) ~ "Corraline",
is.na(`Pocillopora verrucosa`) &
is.na(CCA) == FALSE &
is.na(Dictyota) == FALSE &
is.na(`Porites lobata`) |
is.na(CCA) == FALSE &
is.na(Turf) == FALSE &
is.na(`Porites lobata`) &
is.na(`Pocillopora verrucosa`) ~ "Algae",
is.na(`Dictyota`) &
is.na(CCA)  &
is.na(Turf) &
is.na(`Porites lobata`) == FALSE &
is.na(`Pocillopora verrucosa`) == FALSE ~ "Coral",
is.na(`Dictyota`) == FALSE &
is.na(CCA)  &
is.na(Turf) == FALSE &
is.na(`Porites lobata`) &
is.na(`Pocillopora verrucosa`) ~ "Fleshy Algae",
is.na(CCA)  &
is.na(Dictyota) &
is.na(Turf) == FALSE &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "Turf",
number_exudate_organisms > 3 &
number_exudate_organisms < 6 ~ "Primary Producers",
number_exudate_organisms == 6 ~ "Planktonic",
TRUE ~ "Cosmo"))))%>%
unnest(data)
t_test_features <- compound_prevalance%>%
left_join(networking, by = "feature_number")
grouped_t_test_features <- t_test_features%>%
group_by(exudate_type, DayNight, activity)%>%
nest()
View(grouped_t_test_features)
View(grouped_t_test_features[[4]][[3]])
# META-STATS --Compounds prevalance ---------------------------------------
compound_prevalance <- t_pvals%>%
mutate(exudate_type = 1)%>%
mutate(fdr_mixed = case_when(FDR_greater < 0.05 ~ FDR_greater,
FDR_lesser < 0.05 ~ FDR_lesser))%>%
select(c(1:3, activity, fdr_mixed))%>%
group_by(DayNight, activity)%>%
nest()%>%
mutate(data = map(data, ~ spread(.x, Organism, fdr_mixed)%>%
add_column(number_exudate_organisms = rowSums(.[2:ncol(.)] >= 0, na.rm = TRUE))))
View(compound_prevalance)
View(compound_prevalance[[3]][[1]])
View(t_pvals)
View(t_pvals%>%   mutate(exudate_type = 1)%>%
mutate(fdr_mixed = case_when(FDR_greater < 0.05 ~ FDR_greater,
FDR_lesser < 0.05 ~ FDR_lesser))%>%
select(c(1:3, activity, fdr_mixed))%>%
group_by(DayNight, feature_number)%>%
nest()%>%
mutate(data = map(data, ~ group_by(.x, activity)%>%))
View(t_pvals%>%   mutate(exudate_type = 1)%>%
+          mutate(fdr_mixed = case_when(FDR_greater < 0.05 ~ FDR_greater,
+                                       FDR_lesser < 0.05 ~ FDR_lesser))%>%
+          select(c(1:3, activity, fdr_mixed))%>%
+          group_by(DayNight, feature_number)%>%
+          nest()%>%
+          mutate(data = map(data, ~ group_by(.x, activity)%>%
summarize_if(is.numeric, sum)))
)
View(t_pvals%>%
mutate(exudate_type = 1)%>%
mutate(fdr_mixed = case_when(FDR_greater < 0.05 ~ FDR_greater,
FDR_lesser < 0.05 ~ FDR_lesser))%>%
select(c(1:3, activity, fdr_mixed))%>%
group_by(DayNight, feature_number)%>%
nest()%>%
mutate(data = map(data, ~ group_by(.x, activity)%>%
summarize_if(is.numeric, sum))))
View((t_pvals %>% mutate(exudate_type = 1) %>% mutate(fdr_mixed = case_when(FDR_greater <      0.05 ~ FDR_greater, FDR_lesser < 0.05 ~ FDR_lesser)) %>%      select(c(1:3, activity, fdr_mixed)) %>% group_by(DayNight,      feature_number) %>% nest() %>% mutate(data = map(data, ~group_by(.x,      activity) %>% summarize_if(is.numeric, sum))))[[3]][[1]])
test <- t_pvals%>%
mutate(exudate_type = 1)%>%
mutate(fdr_mixed = case_when(FDR_greater < 0.05 ~ FDR_greater,
FDR_lesser < 0.05 ~ FDR_lesser))%>%
select(c(1:3, activity, fdr_mixed))%>%
group_by(DayNight, feature_number)%>%
nest()%>%
mutate(data = map(data, ~ group_by(.x, activity)%>%
summarize_if(is.numeric, sum))))
test <- t_pvals%>%
mutate(exudate_type = 1)%>%
mutate(fdr_mixed = case_when(FDR_greater < 0.05 ~ FDR_greater,
FDR_lesser < 0.05 ~ FDR_lesser))%>%
select(c(1:3, activity, fdr_mixed))%>%
group_by(DayNight, feature_number)%>%
nest()%>%
mutate(data = map(data, ~ group_by(.x, activity)%>%
summarize_if(is.numeric, sum)))
View(test[[4]][1])
View(test[[4]])
View(test[[2]])
View(test[[3]])
View(test[[3]][1])
test[[3]][1][[1]]
# META-STATS --Compounds prevalance ---------------------------------------
compound_prevalance <- t_pvals%>%
mutate(exudate_type = 1)%>%
mutate(fdr_mixed = case_when(FDR_greater < 0.05 ~ FDR_greater,
FDR_lesser < 0.05 ~ FDR_lesser))%>%
select(c(1:3, activity, fdr_mixed))%>%
group_by(DayNight, activity)%>%
nest()%>%
mutate(data = map(data, ~ spread(.x, Organism, fdr_mixed)%>%
add_column(number_exudate_organisms = rowSums(.[2:ncol(.)] >= 0, na.rm = TRUE))))
View(compound_prevalance)
View(compound_prevalance[[3]][[2]])
# META-STATS --Compounds prevalance ---------------------------------------
compound_prevalance <- t_pvals%>%
mutate(exudate_type = 1)%>%
mutate(fdr_mixed = case_when(FDR_greater < 0.05 ~ FDR_greater,
FDR_lesser < 0.05 ~ FDR_lesser))%>%
select(c(1:3, activity, fdr_mixed))%>%
group_by(DayNight, activity)%>%
nest()%>%
mutate(data = map(data, ~ spread(.x, Organism, fdr_mixed)%>%
add_column(number_exudate_organisms = rowSums(.[2:ncol(.)] >= 0, na.rm = TRUE))%>%
mutate(exudate_type = case_when(is.na(CCA) == FALSE &
is.na(Dictyota) &
is.na(Turf) &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "CCA",
is.na(CCA)  &
is.na(Dictyota) == FALSE &
is.na(Turf) &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "Dictyota",
is.na(CCA)  &
is.na(Dictyota) &
is.na(Turf) == FALSE &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "Turf",
is.na(CCA) &
is.na(Dictyota) &
is.na(Turf) &
is.na(`Pocillopora verrucosa`) == FALSE &
is.na(`Porites lobata`) ~ "Pocillopora verrucosa",
is.na(CCA) &
is.na(Dictyota) &
is.na(Turf) &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) == FALSE ~ "Porites lobata",
is.na(`Pocillopora verrucosa`) == FALSE &
is.na(CCA) == FALSE &
is.na(Dictyota) &
is.na(Turf)  |
is.na(`Porites lobata`) == FALSE &
is.na(CCA) == FALSE &
is.na(Dictyota) &
is.na(Turf) ~ "Corraline",
is.na(`Pocillopora verrucosa`) &
is.na(CCA) == FALSE &
is.na(Dictyota) == FALSE &
is.na(`Porites lobata`) |
is.na(CCA) == FALSE &
is.na(Turf) == FALSE &
is.na(`Porites lobata`) &
is.na(`Pocillopora verrucosa`) ~ "Algae",
is.na(`Dictyota`) &
is.na(CCA)  &
is.na(Turf) &
is.na(`Porites lobata`) == FALSE &
is.na(`Pocillopora verrucosa`) == FALSE ~ "Coral",
is.na(`Dictyota`) == FALSE &
is.na(CCA)  &
is.na(Turf) == FALSE &
is.na(`Porites lobata`) &
is.na(`Pocillopora verrucosa`) ~ "Fleshy Algae",
is.na(CCA)  &
is.na(Dictyota) &
is.na(Turf) == FALSE &
is.na(`Pocillopora verrucosa`)  &
is.na(`Porites lobata`) ~ "Turf",
number_exudate_organisms > 3 &
number_exudate_organisms < 6 ~ "Primary Producers",
number_exudate_organisms == 6 ~ "Planktonic",
TRUE ~ "Cosmo"))))%>%
unnest(data)
t_test_features <- compound_prevalance%>%
left_join(networking, by = "feature_number")
grouped_t_test_features <- t_test_features%>%
group_by(exudate_type, DayNight, activity)%>%
nest()
View(t_test_features)
t_test_feature_inchi <- t_test_features%>%
select(feature_number, inchi_key)%>%
filter(unique(feature_number))
t_test_feature_inchi <- t_test_features%>%
ungroup()%>%
select(feature_number, inchi_key)%>%
filter(unique(feature_number))
t_test_feature_inchi <- t_test_features%>%
ungroup()%>%
select(feature_number, inchi_key)%>%
unqiue()
t_test_feature_inchi <- t_test_features%>%
ungroup()%>%
select(feature_number, inchi_key)%>%
unique()
View(t_test_feature_inchi)
t_test_feature_inchi <- t_test_features%>%
ungroup()%>%
select(feature_number, inchi_key)%>%
unique()%>%
filter(!is.na(inchi_key))
t_test_feature_inchi <- t_test_features%>%
filter(activity != "recalcitrant")
t_test_feature_inchi <- t_test_features%>%
filter(activity != "recalcitrant")%>%
ungroup()%>%
select(feature_number, inchi_key)%>%
unique()%>%
filter(!is.na(inchi_key))
write_csv(t_test_feature_inchi, "~/Documents/GitHub/DORCIERR/data/analysis/inchi_key_norecal.csv")
write_tsv(t_test_feature_inchi, "~/Documents/GitHub/DORCIERR/data/analysis/inchi_key_norecal.tsv")
